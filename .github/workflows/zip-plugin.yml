# Nom du workflow qui appara√Ætra dans l'onglet "Actions" de votre d√©p√¥t GitHub
name: Cr√©er l'archive du plugin

# --- D√âCLENCHEUR ---
# Cette section indique √† GitHub de lancer l'action √† chaque push sur la branche 'main'.
# Si votre branche principale s'appelle 'master', remplacez 'main' ci-dessous.
on:
  push:
    branches:
      - main

# --- T√ÇCHES (JOBS) ---
# Un workflow est compos√© d'une ou plusieurs t√¢ches qui s'ex√©cutent sur des serveurs.
jobs:
  # Nom de la t√¢che
  zip-and-commit:
    # Utilise un serveur Ubuntu r√©cent pour ex√©cuter les commandes
    runs-on: ubuntu-latest

    # --- √âTAPES (STEPS) ---
    # Liste des actions √† ex√©cuter s√©quentiellement
    steps:
      # √âtape 1 : R√©cup√©rer le code de votre d√©p√¥t sur le serveur
      # C'est indispensable pour pouvoir acc√©der √† vos fichiers.
      - name: 1. R√©cup√©ration du code
        uses: actions/checkout@v4

      # √âtape 2 : Cr√©er l'archive Zip
      # Cette √©tape se d√©place dans le bon dossier puis lance la compression.
      # C'est la m√©thode la plus fiable pour g√©rer les chemins complexes.
      - name: 2. Compression du r√©pertoire en .zip
        run: |
          cd "DIMA/plugin/plugin_chrome/fichiers √† t√©l√©charger/"
          zip -r Plugin-dima.zip Plugin-dima
        
      # √âtape 3 : Commiter et pousser le fichier .zip sur le d√©p√¥t
      # Utilise une action pr√©-faite pour commiter le fichier zip g√©n√©r√©.
      # Le commit sera fait automatiquement au nom de "GitHub Actions".
      - name: 3. Commit de l'archive sur le d√©p√¥t
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          # Le message du commit qui sera cr√©√©
          commit_message: "ü§ñ CI : Mise √† jour automatique de l'archive Plugin-dima.zip"
          
          # Le chemin exact du fichier √† commiter
          file_pattern: 'DIMA/plugin/plugin_chrome/fichiers √† t√©l√©charger/Plugin-dima.zip'
